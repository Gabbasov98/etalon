$(".fg input").each(function(index, el) {
    InputIsFilled($(el))
});

$(".fg textarea").each(function(index, el) {
    InputIsFilled($(el))
});


$(".fg select").each(function(index, el) {
    InputIsFilled($(el))
});

$(".fg input").change(function() {
    InputIsFilled($(this))
})

$(".fg textarea").change(function() {
    InputIsFilled($(this))
})

$(".fg select").change(function() {
    InputIsFilled($(this))
})


function InputIsFilled(el) {
    if ($(el).val()) {
        $(el).addClass("input-active")
    } else {
        $(el).removeClass("input-active")
    }
}

$(".tab").click(function() {
    let parentBlock = $(this).parents(".tabs-parent")
    let tabId = $(this).attr("data-tab")
    console.log(parentBlock)
    $(parentBlock).find(".tab").removeClass("_active")
    $(this).addClass("_active")
    $(parentBlock).find(".tab-content").removeClass("_active")
    $(parentBlock).find(`.tab-${tabId}`).addClass("_active")
})


let lastBreadcrumbs = $(".breadcrumbs__item:last-child")
cutBread()
$(window).resize(function () {
    cutBread()
})

function cutBread() {
    let lastBreadcrumbsText
    if(window.innerWidth>1200){
        lastBreadcrumbsText = kitCut($(lastBreadcrumbs).text(), 30)

    } else{
        lastBreadcrumbsText = kitCut($(lastBreadcrumbs).text(), 60)
        console.log(lastBreadcrumbsText)
    }

    $(lastBreadcrumbs).text(lastBreadcrumbsText)
}


function kitCut(text, limit){
    text = text.trim();
    if( text.length <= limit) return text;

    text = text.slice(0, limit);

    return text.trim() + "...";
}


let fancybox = document.querySelectorAll("[data-fancybox]")

Fancybox.defaults.placeFocusBack = false

$(".cookie-modal__confirm").click(function () {
    $(".cookie-modal").removeClass("_show")
})

$(".share-modal__link").click(function() {
    let el = $(this).find("span")
    var $tmp = $("<textarea>");
    $("body").append($tmp);
    $tmp.val($(el).text()).select();
    document.execCommand("copy");
    $tmp.remove();
})

var lastScrollTop = 0;
$(window).scroll(function(){
    setFixHeader()
});

setFixHeader()


function setFixHeader() {
    var st = $(this).scrollTop();
    if(st < 150){
        $(".header").removeClass("_fix")
        $(".header").removeClass("_transform")
        return
    }
    if (st > lastScrollTop){
        $(".header").removeClass("_fix")
        $(".header").addClass("_transform")
    } else {
        $(".header").addClass("_fix")
        $(".header").removeClass("_transform")
    }
    lastScrollTop = st;
}

$("._toggle-menu").click(function () {
    $(".header").toggleClass("_open-menu")
    $("body").toggleClass("fixed-body")
})


$(document).mouseup(function(e) {
    var div = $('.header');
    if (!div.is(e.target) && div.has(e.target).length === 0) {
        if($(div).hasClass("_open-menu")){
            $(div).removeClass("_open-menu")
        }
    }
});


$(".header-search__field input").on("input",function () {
    let val = $(this).val()
    if(val.length > 3){
        $(".header-search").addClass("_filled")
        setTimeout(()=>{
            $(".header-search").addClass("_close-load")
            $(".header-search").addClass("_show-results")
            if(window.innerWidth > 1200){
                $("body").addClass("fixed-body")
            } else{
                $(".header__mob").addClass("fixed-body")
            }
        },1000)
    } else{
        $(".header-search").removeClass("_filled")
        $(".header-search").removeClass("_close-load")
    }
})

$(".header-search__clear").click(function () {
    closeSearch()
})

$(".header-search__bg").click(function () {
    closeSearch()
})

// $(document).keyup(function(e) {
//     if (e.key === "ArrowDown" || e.keyCode === 27) {
//         if(!$(".header-search").hasClass("_show-results")){
//             return
//         }
//     }
// });

document.addEventListener('keydown', e => {
    if (e.key !== 'ArrowUp' && e.key !== 'ArrowDown') return;
    const focusElem = document.querySelector(':focus');
    const tabElements = [...document.querySelectorAll('.header-search__field input, .header-search__items .search-card')];
    const tabElementsCount = tabElements.length - 1;
    if (!tabElements.includes(focusElem)) return;
    e.preventDefault();
    const focusIndex = tabElements.indexOf(focusElem);
    let elemToFocus;
    if (e.key === 'ArrowUp') elemToFocus = tabElements[focusIndex > 0 ? focusIndex - 1 : tabElementsCount];
    if (e.key === 'ArrowDown') elemToFocus = tabElements[focusIndex < tabElementsCount ? focusIndex + 1 : 0];
    elemToFocus.focus();
});

function closeSearch() {
    $(".header-search__field input").val("")
    $(".header-search").removeClass("_filled")
    $(".header-search").removeClass("_close-load")
    $(".header-search").removeClass("_show-results")
    if(window.innerWidth > 1200){
        $("body").removeClass("fixed-body")
    } else{
        $(".header__mob").removeClass("fixed-body")
    }
}

$(".menu__link2-show").click(function () {
    $(this).siblings("._hidden").removeClass("_hidden")
    $(this).hide()
})

$("[data-menu]").click(function () {
    let id = $(this).attr("data-menu")
    $("[data-menu]").removeClass("_active")
    $(this).addClass("_active")

    $(".menu__content").removeClass("_active")
    $(`._${id}`).addClass("_active")

    if(window.innerWidth <= 1200){
        $(".header__mob").addClass("fixed-body")
        $(".menu__cell1").addClass("_active")
    }
})


function closeCell1(){
    $(".header__mob").removeClass("fixed-body")
    $(".menu__cell1").removeClass("_active")
}

$(".menu__content > .menu__nav .menu__back").click(function () {
    closeCell1()
})


$("[data-menu2]").click(function () {
    let id = $(this).attr("data-menu2")
    let parent = $(this).parents(".menu__content")
    $(parent).find("[data-menu2]").removeClass("_active")
    $(this).addClass("_active")

    $(parent).find(".menu__subcontent").removeClass("_active")
    $(parent).find(`._${id}`).addClass("_active")

    if(window.innerWidth <= 1200){
        $(".header__mob").addClass("fixed-body")
        $(".menu__cell2").addClass("_active")
    }
})

function closeCell2(){
    // $(".header__mob").removeClass("fixed-body")
    $(".menu__cell2").removeClass("_active")
}

$(".menu__subcontent > .menu__nav .menu__back").click(function () {
    closeCell2()
})

$("._show-burger").click(function () {
    $(".header").toggleClass("_open-burger")
    $("body").toggleClass("fixed-body")
})

$(".header-adv__close").click(function () {
    $(".header-adv").addClass("_hidden")
})

function mainSlider() {
    let delay = 5000

    var swiper = new Swiper('.main .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 60,
        loop: true,
        speed: 2000,
        loopAdditionalSlides: 10,
        autoplay:{
          delay: delay
        },
        navigation: {
            nextEl: '.main .swiper-button-next',
            prevEl: '.main .swiper-button-prev',
        },
        pagination: {
            el: '.main .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
    })


    $(".main .swiper-container").mouseenter(function() {
        swiper.autoplay.stop();
    });
    $(".main .swiper-container").mouseleave(function() {
        swiper.autoplay.start();
    });
}

function saleSlider() {
    var swiper = new Swiper('.sale .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 20,
        pagination: {
            el: '.sale .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
    })
}

function infoSlider() {
    var swiper = new Swiper('.info__slider .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 0,
        pagination: {
            el: '.info__slider .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
    })
}

function partnersSlider() {
    var swiper = new Swiper('.partners .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 20,
        pagination: {
            el: '.partners .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
    })
}

function aboutSlider() {
    var swiper = new Swiper('.about__slider .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 20,
        effect: 'fade',
        fadeEffect: {
            crossFade: true
        },
        pagination: {
            el: '.about__slider .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
        navigation: {
            nextEl: '.about__slider .swiper-button-next',
            prevEl: '.about__slider .swiper-button-prev',
        },
    })
}

function popularSlider() {
    var swiper = new Swiper('.popular .swiper-container', {
        slidesPerView: 4,
        spaceBetween: 20,
        pagination: {
            el: '.popular .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
        navigation: {
            nextEl: '.popular .swiper-button-next',
            prevEl: '.popular .swiper-button-prev',
        },
        breakpoints:{
            320: {
                slidesPerView: 1
            },
            768: {
                slidesPerView: 2
            },
            992: {
                slidesPerView: 3
            },
            1300: {
                slidesPerView: 4
            }
        }
    })
}

function gallery() {
    var swiper = new Swiper(".gallery .mySwiper", {
        spaceBetween: 8,
        slidesPerView: "auto",
        freeMode: true,
        watchSlidesProgress: true,
        direction: 'horizontal',
        breakpoints:{
            320: {
                direction: 'horizontal',
            },
            1300: {
                direction: 'horizontal',
            }
        }
    });
    var swiper2 = new Swiper(".gallery .mySwiper2", {
        spaceBetween: 10,
        thumbs: {
            swiper: swiper,
        },
        navigation: {
            nextEl: '.gallery .swiper-button-next',
            prevEl: '.gallery .swiper-button-prev',
        },
        pagination: {
            el: '.gallery .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
    });
}

function historySlider() {
    var swiper = new Swiper('.history .swiper-container', {
        slidesPerView: 4,
        spaceBetween: 20,
        pagination: {
            el: '.history .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
        navigation: {
            nextEl: '.history .swiper-button-next',
            prevEl: '.history .swiper-button-prev',
        },
        breakpoints:{
            320: {
                slidesPerView: 1
            },
            768: {
                slidesPerView: 2
            },
            992: {
                slidesPerView: 3
            },
            1300: {
                slidesPerView: 4
            }
        }
    })
}

mainSlider()
saleSlider()
infoSlider()
partnersSlider()
aboutSlider()
popularSlider()
gallery()
historySlider()

function isSailCardChecked(){
    let isChecked = true
    $(".cart-card__check input").each(function (index, el){
        let checked = $(el).prop("checked")
        if(!checked){
            isChecked = false
        }
    });
    return isChecked
}

isSailCardChecked()

$(".cart-card__check input").change(function () {
    if(isSailCardChecked()){
        $(".cart__check-all input").prop("checked",true)
    } else{
        $(".cart__check-all input").prop("checked",false)
    }
})

$(".cart__check-all input").change(function () {
    let checked = $(this).prop("checked")
    $(".cart-card__check input").each(function (index, el){
        $(el).prop("checked",checked)
    });
})

function cartCalc(){
    $('.cartcalc .ccalc-minus').click(function(){
        let a = $(this).closest('.cartcalc').find('input').val();
        if(a>1){
            let b = +a-1;
            $(this).closest('.cartcalc').find('input').val(b);
        }else{
            $(this).closest('.cartcalc').find('input').val(a);
            $(this).parents(".sale-card2__nav").find("._add-cart").removeClass("_active")
        }
    });
    $('.cartcalc .ccalc-plus').click(function(){
        let a = $(this).closest('.cartcalc').find('input').val();
        let b = +a+1;
        $(this).closest('.cartcalc').find('input').val(b);
    });
}

cartCalc()


$("._add-cart").click(function () {
    $(this).siblings(".sale-card2__cart").find("input").val(1)
    $(this).addClass("_active")
})

$(".catalog-nav__item-show").click(function () {
    $(this).siblings(".catalog-nav__item-hidden").slideToggle()
    $(this).toggleClass("_open")
})


$(".types__items").each(function (index, el){
    let count = $(el)[0].childNodes.length/2

    if(count < 5){
        $(el).addClass("_flex-columns")
    }
});

$(".seo__toggle").click(function () {
    $(".seo._collapsable").toggleClass("_expanded")
})

$("._show-filter").click(function () {
    $(".filter").addClass("_active")
})

$("._hide-filter").click(function () {
    $(".filter").removeClass("_active")
})

$("._view1").click(function () {
    $(".subgroup__grid").addClass("_column")
    $(".mob-filter__view").removeClass("_active")
    $(this).addClass("_active")
})

$("._view2").click(function () {
    $(".subgroup__grid").removeClass("_column")
    $(".mob-filter__view").removeClass("_active")
    $(this).addClass("_active")
})

let gallerySlides = $(".gallery__big .swiper-slide").length
console.log(gallerySlides)
if(gallerySlides < 4){
    $(".gallery").addClass("_hide-nav")
} else{
    $(".gallery").removeClass("_hide-nav")
}

if(gallerySlides < 2){
    $(".gallery").addClass("_only-one")
} else{
    $(".gallery").removeClass("_only-one")
}

$(".sale-card3__btn").click(function () {
    $(this).addClass("_active")
})

$(".sale-card3 .sale-card2__btn2").click(function () {
    $(this).siblings(".sale-card3__btn").removeClass("_active")
})

$(document).ready(function() {
    $('input[type="tel"]').mask('+7 999 999-9999', { autoclear: false }, { placeholder: '+7             ' });
    $(".m-select").niceSelect()





});

//# sourceMappingURL=../sourcemaps/main.min.js.map
